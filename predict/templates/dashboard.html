{% extends "sidebar.html" %}

{% block head %}
{{ super() }}
<link rel="stylesheet" type="text/css" href="{{ url_for('static', filename='dashboard.css') }}">
{% endblock %}

{% block title %}Dashboard{% endblock %}

{% block content %}

<div class="jumbotron">
    <h1>Predict Dashboard</h1>
</div>

<form id="main-query" class="sidebar-element" onsubmit="return goto_cve('main-input', 'main-button')()">
    <div class="input-group">
        <input type="text" id="main-input" class="form-control" placeholder="CVE ID">
        <div class="input-group-append">
            <button id="main-button" class="btn btn-outline-dark" type="submit">
                Analyze
            </button>
        </div>
    </div>
</form>

<div id="cve-tools" class="card-deck">
    <div id="export" class="card">
        <div class="card-body">
            <h3 class="card-title">Data Export</h3>
            <p class="card-text">Use the menu below to specify how you want your data exported.</p>

            <form>
                <div class="form-group">
                    <label for="filters">Filters</label>
                    <select id="filters" class="form-control">
                        <option value="none">None</option>
                    {% for plugin in plugins["filter"] %}
                        <option value="{{ plugin.id }}">{{ plugin.description }}</option>
                    {% endfor %}
                    </select>
                    <small class="form-text text-muted">
                        Select filters to apply to the data.
                    </small>
                </div>

                <div class="form-group">
                    <label for="filters">Additional Data</label>
                    <select id="filters" class="form-control" multiple>
                    {% for plugin in plugins["data"] %}
                        <option value="{{ plugin.id }}">{{ plugin.description }}</option>
                    {% endfor %}
                    </select>
                    <small class="form-text text-muted">
                        Select what additional data you would like to export.
                    </small>
                </div>

                <div class="form-group">
                    <label for="strategy">Conflict Resolution Strategy</label>
                    <select id="file-format" class="form-control">
                        <option value="none">None</option>
                    {% for plugin in plugins["conflict"] %}
                        <option value="{{ plugin.id }}">{{ plugin.description }}</option>
                    {% endfor %}
                    </select>
                    <small class="form-text text-muted">
                        The strategy to use when there are conflicts in the data.
                    </small>
                </div>

                <div class="form-group">
                    <label for="file-format">File Format</label>
                    <select id="file-format" class="form-control">
                    {% for plugin in plugins["format"] %}
                        <option value="{{ plugin.id }}">{{ plugin.description }}</option>
                    {% endfor %}
                    </select>
                    <small class="form-text text-muted">
                        The file format you want the data in.
                    </small>
                </div>

                <input type="submit" class="form-control" value="Export">
            </form>
        </div>
    </div>

    <div id="review" class="card">
        <div class="card-body">
            <div class="d-flex w-100 justify-content-between">
                <h3 class="card-title">Review</h3>
                <a href="{{ url_for('main.conflict_resolution') }}">Resolve Conflicts</a>
            </div>
            <p class="card-text">Review your past labels.</p>

            {# TODO this needs to be in order of most recently edited!!!! #}
            <div id="review-cards">
            {% for group, labels in recent_labels %}
              <div class="card border-dark review-card">
                  <a href="{{ url_for('main.cve_base', cve_id=group) }}" class="card-header text-reset">
                      {{ group }}
                  </a>
                  {% for label in labels %}
                      <ul class="list-group list-group-flush">
                          <li class="list-group-item {% if conflicted %}text-danger{% endif %} d-flex w-100 justify-content-between">
                              <div class="label-desc">
                                  <a {# href="{{ fix_file_link }}" #}>{{ label.fix_file }}</a>
                                  @
                                  <a {# href="{{ fix_hash_link }}" #}>{{ label.fix_hash }}</a>
                                  ‚Üê
                                  <a {# href="{{ intro_file_link }}" #}>{{ label.intro_file }}</a>
                                  @
                                  <a {# href="{{ intro_hash_link }}" #}>{{ label.intro_hash }}</a>
                              </div>
                              <small>{{ label.edit_date }}</small>
                          </li>
                      </ul>
                  {% endfor %}
              </div>
            {% endfor %}
            </div>
        </div>
    </div>
</div>

{% endblock %}
