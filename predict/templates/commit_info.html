{% extends "cve_sidebar.html" %}

{% block head %}
{{ super() }}
<link rel="stylesheet" type="text/css" href="{{ url_for('static', filename='info.css') }}">
{% endblock %}

{% block title %}Git Commit Info{% endblock %}
{% block content %}
<div style="text-align: center;">
  <div style="display: inline-block; text-align: left;">
    <h1>{{ github_data["commit_hash"] }}</h1>
    <pre>{{ github_data["commit_description"] }}</pre>
  </div>
</div>
<! making grid system to hold files>
<div class="container">
  <div class="row">
    {% for file in github_data["files"].keys() %}
    <div class="col-xl-6">
      <div>
        <a href="{{ github_data["files"][file].get("file_link") }}"><b>{{ file }}</b></a>
        <a href="{{ github_data["files"][file].get("history_link") }}">HISTORY</a>
        <a href="{{ github_data["files"][file].get("blame_link") }}">BLAME</a>
        <p>
            Diff:
        </p>
      </div>

      <div class="overflow-auto" style="height: 400px;">
        <ul>
          {% for diff_line in github_data["files"][file].get("sorted_line_numbers") %}
              <li>
              <div>
                <! want to represent altered code lines with a more readily interpreted color scheme currently expressed
                  as red## | blue * being the deleted line and red* | blue## as the changed line>
                  <! keep the numbers but change the text color, possibly yellow for change, red for delete. how to find which is which though>
                  <span style="color:red; width: 20%" align="left">
                      {{ github_data["files"][file]["inline_diff"][diff_line]["old_text_line_number"] }} |
                  </span>
                  <span style="color:blue; width: 20%" align="left">
                      {{ github_data["files"][file]["inline_diff"][diff_line]["new_text_line_number"] }}
                  </span>
                  <! for line links to blame line number 116 in github.py will have to change to accept another variable>
                  <! or I make this box a form field and just alter the blame page a little.>

                  {% if github_data["files"][file]["inline_diff"][diff_line]["old_text_line_number"] == "*" %}

                    <span style="color: green;">
                      {{ github_data["files"][file]["inline_diff"][diff_line]["text"] }}
                    </span>
                  {% elif github_data["files"][file]["inline_diff"][diff_line]["new_text_line_number"] == "*" %}
                    <span style="color: orange;">
                      {{ github_data["files"][file]["inline_diff"][diff_line]["text"] }}
                    </span>
                  {% else %}
                    <span>
                      {{ github_data["files"][file]["inline_diff"][diff_line]["text"] }}
                    </span>
                  {% endif %}
              </div>
              </li>
          {% endfor %}
        </ul>

      </div>
      <br/>
    </div>
   {% endfor %}
 </div>
</div>
{% endblock %}
